---
ip_field_name: "gce_private_ip"
domain_name: "tsuru2.paas.alphagov.co.uk"
hosts_prefix: "{{ deploy_env }}"
ssl_crt: "{{ gce_ssl_crt }}"
ssl_key: "{{ gce_ssl_key }}"

redis_host_name: "{{ hosts_prefix }}-tsuru-db"
redis_host: "{{ hostvars[redis_host_name][ip_field_name] }}"

tsuru_api_host_name: "{{ hosts_prefix }}-tsuru-api-0"
tsuru_api_host: "{{ hostvars[tsuru_api_host_name][ip_field_name] }}"
tsuru_api_internal_lb: "{{ hosts_prefix }}-api.{{ domain_name }}"
tsuru_api_external_lb: "{{ hosts_prefix }}-api.{{ domain_name }}"

gandalf_host_name: "{{ hosts_prefix }}-tsuru-gandalf"
gandalf_host_internal: "{{ hostvars[gandalf_host_name][ip_field_name] }}"

mongodb_host_name: "{{ hosts_prefix }}-tsuru-db"
mongodb_host: "{{ hostvars[mongodb_host_name][ip_field_name] }}"

postgres_host_name: "{{ hosts_prefix }}-tsuru-postgres"
postgres_host: "{{ hostvars[postgres_host_name][ip_field_name] }}"

influxdb_host_name: "{{ hosts_prefix }}-influx-grafana"
influxdb_url: "http://{{ hostvars[influxdb_host_name][ip_field_name] }}:8086"

# WAL-E Configuration
enable_postgres_log_shipping: true
postgresql_wal_level: hot_standby
postgresql_archive_mode: on
postgres_backup_s3_bucket: "{{ deploy_env }}-mcp-postgres-backup"
wal_e_aws_instance_profile: false
wal_e_aws_access_key: "{{ gs_access_key }}"
wal_e_aws_secret_key: "{{ gs_secret }}"
postgresql_archive_command: "/usr/bin/envdir {{ wal_e_envdir }} /usr/local/bin/wal-e {% if wal_e_aws_instance_profile %}--aws-instance-profile{% endif %} wal-push %p"
wal_e_s3_endpoint: "http+path://storage.googleapis.com"
wal_e_s3_prefix: "s3://{{ postgres_backup_s3_bucket }}/wal-e"
wal_e_pgdata_dir: "/var/lib/postgresql/{{ postgresql_version }}/main/"
